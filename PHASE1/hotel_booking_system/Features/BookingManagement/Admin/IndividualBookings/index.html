<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<link rel="icon" type="image/png" href="/assets/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LuxuryStay - Booking Details</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body class="bg-gray-50">
  <!-- Include Navbar -->
  <div id="navbar"></div>
  <!-- Include Sidebar -->
  <div id="sidebar" class="fixed top-16 left-0 w-64 h-screen shadow-lg bg-white"></div>

  <!-- Add this script before your main script -->
  <script>
    // Fetch and inject navbar
// ✅ Admin Navbar Loader
fetch('/Features/Components/Navbars/AdminMainPageNavbar/index.html')
  .then(response => response.text())
  .then(data => {
    document.getElementById('navbar').innerHTML = data;

    // ✅ Always init notifications after navbar is injected
    initNotifications();
  })
  .catch(err => {
    console.error('❌ Navbar load failed:', err);
    document.getElementById('navbar').innerHTML = `
      <div class="fixed top-0 left-0 right-0 bg-white shadow z-30">
        <div class="max-w-7xl mx-auto p-4 flex justify-between items-center">
          <div class="font-bold text-yellow-600">LuxuryStay</div>
        </div>
      </div>`;
  });


// ✅ Notifications initializer
function initNotifications() {
  const latestNotifs = [
    { type: 'booking', msg: 'New booking: Room 201 confirmed', time: '2m ago' },
    { type: 'issue', msg: 'Issue reported in Room 105', time: '30m ago' },
    { type: 'refund', msg: 'Refund processed for BK#1234', time: '1h ago' }
  ];

  function notifIcon(type) {
    switch (type) {
      case 'booking': return `<i class="fas fa-calendar-check text-green-600"></i>`;
      case 'issue': return `<i class="fas fa-exclamation-triangle text-red-600"></i>`;
      case 'refund': return `<i class="fas fa-money-bill-wave text-yellow-500"></i>`;
      default: return `<i class="fas fa-bell text-gray-500"></i>`;
    }
  }

  function renderNotifs(listId) {
    const list = document.getElementById(listId);
    if (!list) return;
    list.innerHTML = latestNotifs.map(n => `
      <div class="px-4 py-3 flex items-start space-x-3 hover:bg-gray-50">
        <div>${notifIcon(n.type)}</div>
        <div class="flex-1">
          <p class="text-sm text-gray-700">${n.msg}</p>
          <span class="text-xs text-gray-400">${n.time}</span>
        </div>
      </div>
    `).join('');
  }

  // Render into dropdowns
  renderNotifs('notifList');
  renderNotifs('notifListMobile');

  // Show red dot indicators
  document.getElementById('notifDot')?.classList.remove('hidden');
  document.getElementById('notifDotMobile')?.classList.remove('hidden');

  // Dropdown toggles
  const toggleDropdown = (btnId, dropId) => {
    const btn = document.getElementById(btnId);
    const drop = document.getElementById(dropId);
    if (btn && drop) {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        drop.classList.toggle('hidden');
      });
      document.addEventListener('click', (e) => {
        if (!btn.contains(e.target) && !drop.contains(e.target)) {
          drop.classList.add('hidden');
        }
      });
    }
  };

  toggleDropdown('notifBtn', 'notifDropdown');
  toggleDropdown('notifBtnMobile', 'notifDropdownMobile');
}

    // Fetch and inject sidebar
    fetch('/Features/Components/Sidebars/AdminMainPageSidebar/index.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('sidebar').innerHTML = data;
      });
  </script>

  <main class="ml-64 pt-16 p-8 h-screen overflow-y-auto space-y-8">
    <!-- Page Header -->
    <div class="relative rounded-2xl border-2 border-yellow-500 bg-yellow-50 py-8 text-center shadow">
      <h2 class="text-4xl text-gray-800 font-bold">Booking Details</h2>
      <p class="text-gray-600 mt-2">Complete overview of booking #B1001</p>
    </div>

    <!-- Back Button -->
    <div class="flex justify-start">
      <button onclick="window.history.back()" 
              class="flex items-center gap-2 bg-gray-200 hover:bg-gray-300 text-gray-800 px-5 py-2 rounded-lg shadow">
        <span class="material-icons text-sm">arrow_back</span> Back
      </button>
    </div>

    <!-- Modification Request Alert (if exists) -->
    <div id="modificationAlert" class="bg-orange-50 border-l-4 border-l-orange-400 p-4 rounded-lg shadow-md">
      <div class="flex items-center justify-between">
        <div class="flex items-start gap-3">
          <span class="material-icons text-orange-500">warning</span>
          <div>
            <h4 class="font-semibold text-orange-800">Modification Request Pending</h4>
            <p class="text-orange-700 text-sm mt-1">Customer has requested changes to this booking. Review and take action.</p>
            <div class="mt-2 text-sm">
              <p><span class="font-medium">Requested on:</span> 20 Sept 2023, 3:45 PM</p>
              <p><span class="font-medium">Type:</span> Room Change & Date Extension</p>
            </div>
          </div>
        </div>
        <div class="flex gap-2">
          <button onclick="window.location.href='/Features/BookingManagement/Admin/ModifyCustomerBooking/index.html'" class="px-3 py-1 bg-yellow-500 text-white rounded hover:bg-yellow-600 text-sm flex items-center gap-1">
            <span class="material-icons text-sm">edit</span>
            Edit
          </button>
        </div>
      </div>
    </div>

    <!-- Booking Summary -->
    <section class="bg-white rounded-2xl border-2 border-yellow-400 p-6 shadow-md">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-yellow-700">Booking Summary</h3>
        <button onclick="downloadInvoice()" class="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm">
          <span class="material-icons text-sm">download</span>
          Download Invoice
        </button>
      </div>
      <div class="grid md:grid-cols-2 gap-6">
        <!-- Left Column -->
        <div class="space-y-3">
          <p><span class="font-medium">Booking ID:</span> #B1001</p>
          <p><span class="font-medium">Booking Date:</span> 15 Sept 2023</p>
          <p><span class="font-medium">Check-in:</span> 21 Sept 2023, 2:00 PM</p>
          <p><span class="font-medium">Check-out:</span> 25 Sept 2023, 12:00 PM</p>
          <p><span class="font-medium">Total Nights:</span> 4</p>
          <p><span class="font-medium">Total Rooms:</span> 3</p>
          <p><span class="font-medium">Total Guests:</span> 8 (6 Adults, 2 Children)</p>
        </div>
        <!-- Right Column -->
        <div class="space-y-3">
          <p><span class="font-medium">Payment Status:</span> 
            <span class="px-3 py-1 rounded-full bg-green-100 text-green-700 text-xs">Paid</span>
          </p>
          <p><span class="font-medium">Payment Method:</span> Credit Card (**** 2345)</p>
          <p><span class="font-medium">Transaction ID:</span> TXN123456789</p>
          <p><span class="font-medium">Total Amount:</span> ₹45,000</p>
          <p><span class="font-medium">Booking Status:</span> 
            <span class="px-3 py-1 rounded-full bg-blue-100 text-blue-700 text-xs">Active</span>
          </p>
        </div>
      </div>
    </section>

    <!-- Special Requests Section -->
    <section class="bg-white rounded-2xl border-2 border-purple-400 p-6 shadow-md">
      <h3 class="text-lg font-semibold text-purple-700 mb-4 flex items-center gap-2">
        <span class="material-icons">star</span>
        Special Requests & Preferences
      </h3>
      <div class="grid md:grid-cols-2 gap-6">
        <!-- Special Requests -->
        <div class="bg-purple-50 rounded-xl p-4 border border-purple-200">
          <h4 class="font-semibold text-purple-800 mb-3 flex items-center gap-2">
            <span class="material-icons text-sm">request_quote</span>
            Customer Requests
          </h4>
          <div class="space-y-2">
            <div class="flex items-start gap-2">
              <span class="material-icons text-green-600 text-sm mt-0.5">check_circle</span>
              <span class="text-sm">Early check-in (before 2:00 PM) - <span class="text-green-600 font-medium">Approved</span></span>
            </div>
            <div class="flex items-start gap-2">
              <span class="material-icons text-green-600 text-sm mt-0.5">check_circle</span>
              <span class="text-sm">Extra pillows for Room 101 - <span class="text-green-600 font-medium">Fulfilled</span></span>
            </div>
            <div class="flex items-start gap-2">
              <span class="material-icons text-orange-500 text-sm mt-0.5">schedule</span>
              <span class="text-sm">High floor rooms preferred - <span class="text-orange-500 font-medium">Partially Met</span></span>
            </div>
            <div class="flex items-start gap-2">
              <span class="material-icons text-blue-600 text-sm mt-0.5">info</span>
              <span class="text-sm">Quiet rooms away from elevator - <span class="text-blue-600 font-medium">Noted</span></span>
            </div>
          </div>
        </div>
        
        <!-- Dietary & Accessibility -->
        <div class="bg-gray-50 rounded-xl p-4 border border-gray-200">
          <h4 class="font-semibold text-gray-800 mb-3 flex items-center gap-2">
            <span class="material-icons text-sm">accessibility</span>
            Dietary & Accessibility
          </h4>
          <div class="space-y-2">
            <div class="flex items-center gap-2">
              <span class="material-icons text-red-500 text-sm">no_food</span>
              <span class="text-sm">Vegetarian meals only</span>
            </div>
            <div class="flex items-center gap-2">
              <span class="material-icons text-orange-500 text-sm">warning</span>
              <span class="text-sm">Nut allergy (severe)</span>
            </div>
            <div class="flex items-center gap-2">
              <span class="material-icons text-blue-600 text-sm">accessible</span>
              <span class="text-sm">No accessibility requirements</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Customer Information -->
    <section class="bg-white rounded-2xl border-2 border-yellow-400 p-6 shadow-md">
      <h3 class="text-lg font-semibold text-yellow-700 mb-4">Customer Information</h3>
      <div class="grid md:grid-cols-2 gap-6">
        <!-- Primary Guest -->
        <div class="p-4 rounded-xl bg-gray-50 border">
          <h4 class="font-semibold text-gray-800 mb-2">Primary Guest</h4>
          <div class="space-y-2">
            <p><span class="font-medium">Name:</span> Arjun Kumar</p>
            <p><span class="font-medium">Email:</span> arjun.kumar@example.com</p>
            <p><span class="font-medium">Phone:</span> +91 99887 77665</p>
            <p><span class="font-medium">ID Type:</span> Aadhar Card</p>
            <p><span class="font-medium">ID Number:</span> XXXX-XXXX-1234</p>
          </div>
        </div>
        <!-- Additional Guests -->
        <div class="p-4 rounded-xl bg-gray-50 border">
          <h4 class="font-semibold text-gray-800 mb-2">Additional Guests</h4>
          <ul class="list-disc list-inside space-y-2 text-gray-600">
            <li>Priya Kumar (Adult)</li>
            <li>Rahul Kumar (Adult)</li>
            <li>Meera Kumar (Adult)</li>
            <li>Amit Kumar (Child - 8 years)</li>
            <li>Sara Kumar (Child - 6 years)</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Room Details -->
    <section class="bg-white rounded-2xl border-2 border-yellow-400 p-6 shadow-md">
      <h3 class="text-lg font-semibold text-yellow-700 mb-4 flex items-center gap-2">
        <span class="material-icons">hotel</span>
        Room Details & Management
      </h3>
      <div class="space-y-6">
        <!-- Room 1 -->
        <div class="border rounded-xl p-4 hover:shadow-md transition-shadow">
          <div class="flex justify-between items-start mb-4">
            <div>
              <h4 class="font-semibold text-gray-800 flex items-center gap-2">
                <span class="material-icons text-blue-600 text-sm">hotel</span>
                Room 101 - Deluxe Room
              </h4>
              <p class="text-gray-500">₹12,000 per night</p>
            </div>
            <div class="flex items-center gap-2">
              <span class="px-3 py-1 rounded-full bg-green-100 text-green-700 text-xs">Occupied</span>
              <button onclick="transferRoom('101')" class="px-3 py-1 bg-orange-100 text-orange-700 rounded hover:bg-orange-200 text-xs flex items-center gap-1">
                <span class="material-icons text-xs">swap_horiz</span>
                Transfer
              </button>
            </div>
          </div>
          <div class="grid md:grid-cols-2 gap-4">
            <div>
              <p><span class="font-medium">Occupancy:</span> 2 Adults, 1 Child</p>
              <p><span class="font-medium">Bed Type:</span> King Bed</p>
              <p><span class="font-medium">View:</span> City View</p>
            </div>
            <div>
              <p><span class="font-medium">Meal Plan:</span> Breakfast Included</p>
              <p><span class="font-medium">Room Size:</span> 32 sq.m</p>
              <p><span class="font-medium">Floor:</span> 1st Floor</p>
            </div>
          </div>
          <!-- Room-specific special requests -->
          <div class="mt-3 pt-3 border-t border-gray-200">
            <p class="text-sm text-gray-600"><span class="font-medium">Room Notes:</span> Extra pillows provided, Early check-in processed</p>
          </div>
        </div>

        <!-- Room 2 -->
        <div class="border rounded-xl p-4 hover:shadow-md transition-shadow">
          <div class="flex justify-between items-start mb-4">
            <div>
              <h4 class="font-semibold text-gray-800 flex items-center gap-2">
                <span class="material-icons text-blue-600 text-sm">hotel</span>
                Room 205 - Executive Suite
              </h4>
              <p class="text-gray-500">₹18,000 per night</p>
            </div>
            <div class="flex items-center gap-2">
              <span class="px-3 py-1 rounded-full bg-green-100 text-green-700 text-xs">Occupied</span>
              <button onclick="transferRoom('205')" class="px-3 py-1 bg-orange-100 text-orange-700 rounded hover:bg-orange-200 text-xs flex items-center gap-1">
                <span class="material-icons text-xs">swap_horiz</span>
                Transfer
              </button>
            </div>
          </div>
          <div class="grid md:grid-cols-2 gap-4">
            <div>
              <p><span class="font-medium">Occupancy:</span> 2 Adults</p>
              <p><span class="font-medium">Bed Type:</span> King Bed</p>
              <p><span class="font-medium">View:</span> Pool View</p>
            </div>
            <div>
              <p><span class="font-medium">Meal Plan:</span> All Inclusive</p>
              <p><span class="font-medium">Room Size:</span> 45 sq.m</p>
              <p><span class="font-medium">Floor:</span> 2nd Floor</p>
            </div>
          </div>
          <div class="mt-3 pt-3 border-t border-gray-200">
            <p class="text-sm text-gray-600"><span class="font-medium">Room Notes:</span> Premium suite with complimentary amenities</p>
          </div>
        </div>

        <!-- Room 3 with pending transfer request -->
        <div class="border rounded-xl p-4 hover:shadow-md transition-shadow bg-yellow-50 border-yellow-300">
          <div class="flex justify-between items-start mb-4">
            <div>
              <h4 class="font-semibold text-gray-800 flex items-center gap-2">
                <span class="material-icons text-blue-600 text-sm">hotel</span>
                Room 304 - Deluxe Room
                <span class="material-icons text-orange-500 text-sm" title="Transfer pending">pending</span>
              </h4>
              <p class="text-gray-500">₹15,000 per night</p>
            </div>
            <div class="flex items-center gap-2">
              <span class="px-3 py-1 rounded-full bg-green-100 text-green-700 text-xs">Occupied</span>
              <span class="px-3 py-1 rounded-full bg-orange-100 text-orange-700 text-xs">Transfer Pending</span>
              <button onclick="transferRoom('304')" class="px-3 py-1 bg-orange-100 text-orange-700 rounded hover:bg-orange-200 text-xs flex items-center gap-1">
                <span class="material-icons text-xs">swap_horiz</span>
                Manage
              </button>
            </div>
          </div>
          <div class="grid md:grid-cols-2 gap-4">
            <div>
              <p><span class="font-medium">Occupancy:</span> 2 Adults, 1 Child</p>
              <p><span class="font-medium">Bed Type:</span> Twin Beds</p>
              <p><span class="font-medium">View:</span> Garden View</p>
            </div>
            <div>
              <p><span class="font-medium">Meal Plan:</span> Breakfast Included</p>
              <p><span class="font-medium">Room Size:</span> 32 sq.m</p>
              <p><span class="font-medium">Floor:</span> 3rd Floor</p>
            </div>
          </div>
          <div class="mt-3 pt-3 border-t border-orange-200">
            <div class="flex items-start gap-2">
              <span class="material-icons text-orange-500 text-sm mt-0.5">info</span>
              <div>
                <p class="text-sm text-orange-800"><span class="font-medium">Transfer Note:</span> Customer requested room change due to AC issues. Maintenance scheduled.</p>
                <p class="text-xs text-orange-600 mt-1">Requested: 23 Sept 2023, 10:30 AM</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Issues Raised -->
    <section class="bg-white rounded-2xl border-2 border-pink-400 p-6 shadow-md">
      <h3 class="text-lg font-semibold text-yellow-700 mb-4">Issues Raised</h3>
      <div class="space-y-4">
        <div class="border rounded-xl p-4">
          <div class="flex justify-between items-start mb-2">
            <div>
              <h4 class="font-semibold text-gray-800">Room Service Delay</h4>
              <p class="text-gray-500 text-sm">Reported on: 22 Sept 2023</p>
            </div>
            <span class="px-3 py-1 rounded-full bg-green-100 text-green-700 text-xs">Resolved</span>
          </div>
          <p class="text-gray-600 mt-2">Issue with delayed room service. Response time was over 2 hours.</p>
        </div>

        <div class="border rounded-xl p-4">
          <div class="flex justify-between items-start mb-2">
            <div>
              <h4 class="font-semibold text-gray-800">AC Not Working</h4>
              <p class="text-gray-500 text-sm">Reported on: 23 Sept 2023</p>
            </div>
            <span class="px-3 py-1 rounded-full bg-yellow-100 text-yellow-700 text-xs">Pending</span>
          </div>
          <p class="text-gray-600 mt-2">AC temperature control not functioning properly in Room 304.</p>
        </div>
      </div>
    </section>

    <!-- Customer Review -->
    <section class="bg-white rounded-2xl border-2 border-yellow-400 p-6 shadow-md">
      <h3 class="text-lg font-semibold text-yellow-700 mb-4">Customer Review</h3>
      <div class="space-y-4">
        <div class="flex items-center gap-2 mb-4">
          <div class="flex text-yellow-400">
            <span class="material-icons">star</span>
            <span class="material-icons">star</span>
            <span class="material-icons">star</span>
            <span class="material-icons">star</span>
            <span class="material-icons">star_half</span>
          </div>
          <span class="text-xl font-bold text-gray-800">4.5</span>
        </div>
        
        <div class="bg-gray-50 rounded-xl p-4 border">
          <p class="text-gray-700 italic">
            "Overall a pleasant stay. The rooms were spacious and well-maintained. Staff was courteous and helpful. 
            Had some issues with room service timing but it was handled professionally. The pool and gym facilities 
            were excellent. Would recommend for family stays."
          </p>
          <p class="mt-4 text-sm text-gray-500">Review submitted on: 25 Sept 2023</p>
        </div>
      </div>
    </section>

    <!-- Action Buttons -->
    <div class="flex justify-end gap-4">
      <button onclick="editBooking()" class="px-5 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 shadow flex items-center gap-2">
        <span class="material-icons text-sm">edit</span> Edit Booking
      </button>
      <button onclick="cancelBooking()" class="px-5 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 shadow flex items-center gap-2">
        <span class="material-icons text-sm">cancel</span> Cancel Booking
      </button>
    </div>
  </main>



  <!-- Room Transfer Modal -->
  <div id="roomTransferModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
    <div class="bg-white rounded-2xl max-w-lg w-full m-4 p-6">
      <div class="flex items-center justify-between mb-6">
        <h3 class="text-xl font-semibold text-gray-800 flex items-center gap-2">
          <span class="material-icons text-orange-500">swap_horiz</span>
          Transfer Room
        </h3>
        <button onclick="closeTransferModal()" class="text-gray-400 hover:text-gray-600">
          <span class="material-icons">close</span>
        </button>
      </div>
      
      <form id="transferForm" class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Current Room</label>
          <input type="text" id="currentRoom" disabled class="w-full p-3 bg-gray-100 border border-gray-300 rounded-lg">
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Available Rooms</label>
          <select id="newRoom" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500">
            <option value="">Select new room...</option>
            <option value="401">Room 401 - Executive Suite (₹18,000/night)</option>
            <option value="402">Room 402 - Executive Suite (₹18,000/night)</option>
            <option value="105">Room 105 - Deluxe Room (₹12,000/night)</option>
            <option value="206">Room 206 - Deluxe Room (₹15,000/night)</option>
          </select>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Reason for Transfer</label>
          <select id="transferReason" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500">
            <option value="">Select reason...</option>
            <option value="maintenance">Room Maintenance</option>
            <option value="customer_request">Customer Request</option>
            <option value="upgrade">Room Upgrade</option>
            <option value="technical_issue">Technical Issue</option>
            <option value="other">Other</option>
          </select>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Additional Notes</label>
          <textarea id="transferNotes" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 resize-none" 
                    placeholder="Any additional details about the transfer..."></textarea>
        </div>
        
        <div class="bg-yellow-50 p-3 rounded-lg border border-yellow-200">
          <p class="text-sm text-yellow-800 flex items-start gap-2">
            <span class="material-icons text-yellow-600 text-sm mt-0.5">info</span>
            The customer will be notified about the room change and any price differences will be adjusted in the final bill.
          </p>
        </div>
        
        <div class="flex justify-end gap-3 pt-4">
          <button type="button" onclick="closeTransferModal()" class="px-4 py-2 text-gray-700 border rounded-lg hover:bg-gray-50">
            Cancel
          </button>
          <button type="submit" class="px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700">
            Confirm Transfer
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Toast Notification -->
  <div id="toast" class="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg transform -translate-y-full opacity-0 transition-all duration-300 z-50">
    Action completed successfully!
  </div>

<script src="./script.js"></script>
</body>
</html>
